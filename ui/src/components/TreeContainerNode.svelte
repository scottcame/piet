<script>

	import TreeLeafNode from './TreeLeafNode.svelte';
	import { TreeModelNode, TreeModelLeafNode, TreeModelContainerNode } from '../js/ui/model/Tree';

	export let treeModelNode;
	let expanded = true;

	function toggle() {
		expanded = !expanded;
	}

</script>

<div class="pl-3">

	<div class="flex inline items-center text-gray-900 mb-1">
		<div class="h-5 w-5 items-center flex">
			{#if treeModelNode.type === 'dataset'}
			<svg class="stroke-current h-24 w-24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
				x="0px" y="0px" viewBox="66.14 99.445 460 491" enable-background="new 66.14 99.445 460 491">
				<g transform="translate(0,-952.36218)">
					<path d="M505.985,1173.889c0-32.937-26.491-59.858-64.178-78.13c-37.687-18.273-88.361-29.02-144.167-29.02   s-106.479,10.747-144.17,29.02c-37.688,18.272-64.178,45.193-64.178,78.13c0.06,82.118,0,166.926,0,250.018   c0,32.937,26.491,59.671,64.178,77.944c37.689,18.273,88.364,29.206,144.17,29.206s106.48-10.933,144.17-29.206   c37.687-18.272,64.178-45.008,64.178-77.943 M297.64,1090.549c52.687,0,100.342,10.402,133.752,26.601   c33.409,16.199,50.785,37.072,50.785,56.738c0,19.666-17.376,40.353-50.785,56.552c-33.41,16.199-81.065,26.788-133.752,26.788   c-52.686,0-100.342-10.589-133.752-26.788s-50.785-36.886-50.785-56.552s17.375-40.54,50.785-56.738   S244.954,1090.549,297.64,1090.549L297.64,1090.549z M113.103,1224.487c10.749,10.503,24.525,19.665,40.367,27.345   c37.689,18.273,88.364,29.207,144.17,29.207s106.48-10.933,144.17-29.207c15.842-7.681,29.618-16.842,40.367-27.345   c0,10.914,0,21.827,0,32.741c0,19.666-17.376,40.353-50.785,56.551c-33.41,16.199-81.065,26.788-133.752,26.788   c-52.686,0-100.342-10.589-133.752-26.788s-50.785-36.886-50.785-56.551C113.103,1246.314,113.103,1235.401,113.103,1224.487   L113.103,1224.487z M113.103,1307.827c10.749,10.503,24.525,19.665,40.367,27.345c37.689,18.273,88.364,29.207,144.17,29.207   s106.48-10.933,144.17-29.207c15.842-7.681,29.618-16.842,40.367-27.345c0,10.914,0,21.827,0,32.74   c0,19.666-17.376,40.353-50.785,56.551c-33.41,16.199-81.065,26.788-133.752,26.788c-52.686,0-100.342-10.589-133.752-26.788   c-33.41-16.198-50.785-36.885-50.785-56.551C113.103,1329.654,113.103,1318.74,113.103,1307.827L113.103,1307.827z    M113.103,1391.166c10.749,10.503,24.525,19.665,40.367,27.345c37.689,18.273,88.364,29.207,144.17,29.207   s106.48-10.933,144.17-29.207c15.842-7.68,29.618-16.842,40.367-27.345v32.74c0,19.665-17.376,40.353-50.785,56.552   c-33.41,16.199-81.065,26.787-133.752,26.787c-52.686,0-100.342-10.588-133.752-26.787c-33.409-16.199-50.785-36.887-50.785-56.552   V1391.166z"></path>
				</g>
			</svg>
			{:else if treeModelNode.type === 'cube'}
			<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" viewBox="0 0 24 24" stroke-width=".3">
				<path d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2zm0 2v14h14V5H5zm8 6h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 0v-2H9a1 1 0 0 1 0-2h2V9a1 1 0 0 1 2 0v2z"/>
			</svg>
			{:else if treeModelNode.type === 'measures'}
			<svg class="h-6 w-6 stroke-current" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" stroke-width=".3">
				<path d="M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20zM5.68 7.1A7.96 7.96 0 0 0 4.06 11H5a1 1 0 0 1 0 2h-.94a7.95 7.95 0 0 0 1.32 3.5A9.96 9.96 0 0 1 11 14.05V9a1 1 0 0 1 2 0v5.05a9.96 9.96 0 0 1 5.62 2.45 7.95 7.95 0 0 0 1.32-3.5H19a1 1 0 0 1 0-2h.94a7.96 7.96 0 0 0-1.62-3.9l-.66.66a1 1 0 1 1-1.42-1.42l.67-.66A7.96 7.96 0 0 0 13 4.06V5a1 1 0 0 1-2 0v-.94c-1.46.18-2.8.76-3.9 1.62l.66.66a1 1 0 0 1-1.42 1.42l-.66-.67zM6.71 18a7.97 7.97 0 0 0 10.58 0 7.97 7.97 0 0 0-10.58 0z"/>
			</svg>
			{:else if treeModelNode.type === 'dimensions'}
			<svg class="h-6 w-6 stroke-current" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" stroke-width="1.5">
				<g fill="none">
					<path d="M10,1 L20,7 L10,13 L0,7 L10,1 Z M16.6666667,11 L20,13 L10,19 L0,13 L3.33333333,11 L10,15 L16.6666667,11 Z"></path>
				</g>
			</svg>
			{/if}
		</div>
		<span on:click={toggle} class="ml-2 font-semibold">{treeModelNode.label}</span>
	</div>

	{#if expanded}
		<ul class="border-l border-grey-300">
			{#each treeModelNode.children as child}
				<li>
					{#if child.hasChildren()}
						<svelte:self treeModelNode={child}/>
					{:else}
						<TreeLeafNode treeModelNode={child}/>
					{/if}
				</li>
			{/each}
		</ul>
	{/if}
</div>
